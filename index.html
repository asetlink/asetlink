<script>
  const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSFl8lDZYVTd3xNTxxdDICGkP7BfRtZqwzxIUp1vmjQM-V4M7OdZmON3bOAFA-rwQW8UsGiHPxPBbqs/pub?output=csv";

  fetch(csvUrl)
    .then(response => response.text())
    .then(text => {
      const rows = text.trim().split("\n").slice(1); // Hilangkan header
      let output = '';
      for (const row of rows) {
        const columns = row.split(",");
        if (columns.length >= 3) {
          const kode = columns[0];
          const judul = columns[1];
          const link = columns.slice(2).join(",").trim(); // Gabungkan sisa jadi satu link (jika link mengandung koma)
          output += `
            <div class="data-item">
              <strong>${kode}</strong> - ${judul}<br>
              <a href="${link}" target="_blank">${link}</a>
            </div>
          `;
        }
      }
      document.getElementById("output").innerHTML = output || "Data kosong atau tidak terbaca.";
    })
    .catch(err => {
      document.getElementById("output").innerText = "Gagal memuat data.";
      console.error(err);
    });
</script>
