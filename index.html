<script>
  const _g = "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvMlBBQ1gtMXZT"
           + "Rmw4bERaWVVWVDN4TlR4eHRESUNHa1A3QmZSdFpxd3p4SVVwMXZtalFNLVY0TTdP"
           + "ZFptT04zYk9BRkEtcndRVzhVc0dpSFB4UEJicXMvcHViP291dHB1dD1jc3Y=";
  const sheetURL = atob(_g);

  let data = [];

  fetch(sheetURL)
    .then(res => res.text())
    .then(text => {
      const rows = text.trim().split("\n").slice(1);
      data = rows.map(row => {
        const [judul, link] = row.split(",");
        return { judul: judul.trim(), link: link.trim() };
      });
    });

  document.getElementById("search").addEventListener("input", function () {
    const keyword = this.value.trim().toLowerCase();
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML = '';

    if (keyword === '') {
      resultDiv.innerHTML = 'Silakan ketik saja, video yang ingin kamu cari.';
      return;
    }

    const found = data.filter(item =>
      item.judul.toLowerCase().includes(keyword)
    );

    if (found.length > 0) {
      found.forEach(item => {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `<strong>${item.judul}</strong><br><a href="${item.link}" target="_blank">${item.link}</a>`;
        resultDiv.appendChild(div);
      });
    } else {
      resultDiv.innerHTML = '<i>Tidak ditemukan. Rekomendasi:</i><br>';
      const rekomendasi = data.slice(0, 5);
      rekomendasi.forEach(item => {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `<strong>${item.judul}</strong><br><a href="${item.link}" target="_blank">${item.link}</a>`;
        resultDiv.appendChild(div);
      });
    }
  });
</script>
